{
	"name": "SQL script 7_Create_DW_tables",
	"properties": {
		"content": {
			"query": "-- Crear esquema\nCREATE SCHEMA insurance_xyz_dw_mart;\nGO\n\n-- Fact Tables\nCREATE TABLE insurance_xyz_dw_mart.Fact_Claims (\n    Claim_ID UNIQUEIDENTIFIER NOT NULL,\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Claim_Date DATE,\n    Claim_Amount DECIMAL(18,2),\n    Claim_Status NVARCHAR(100),\n    Fraud_Score FLOAT,\n    Risk_Score FLOAT\n)\nWITH (DISTRIBUTION = HASH(Claim_ID), HEAP);\n\nCREATE TABLE insurance_xyz_dw_mart.Fact_Policies (\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Premium_Amount DECIMAL(18,2),\n    Start_Date DATE,\n    End_Date DATE,\n    Policy_Type NVARCHAR(100)\n)\nWITH (DISTRIBUTION = HASH(Policy_ID), HEAP);\n\nCREATE TABLE insurance_xyz_dw_mart.Fact_Customer_Risk (\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Risk_Score FLOAT,\n    Number_of_Claims INT,\n    Premium_Amount DECIMAL(18,2),\n    Economic_Index FLOAT,\n    Weather_Conditions NVARCHAR(MAX)\n)\nWITH (DISTRIBUTION = HASH(Client_ID), HEAP);\n\n-- Dimension Tables\nCREATE TABLE insurance_xyz_dw_mart.Dim_Clients (\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Client_Name NVARCHAR(255),\n    Address NVARCHAR(255),\n    Phone NVARCHAR(50),\n    Birth_Date DATE,\n    Risk_Category NVARCHAR(100)\n)\nWITH (DISTRIBUTION = HASH(Client_ID), HEAP);\n\nCREATE TABLE insurance_xyz_dw_mart.Dim_Policies (\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Policy_Type NVARCHAR(100),\n    Premium_Amount DECIMAL(18,2),\n    Coverage_Details NVARCHAR(MAX)\n)\nWITH (DISTRIBUTION = HASH(Policy_ID), HEAP);\n\nCREATE TABLE insurance_xyz_dw_mart.Dim_Claims (\n    Claim_ID UNIQUEIDENTIFIER NOT NULL,\n    Claim_Date DATE,\n    Claim_Amount DECIMAL(18,2),\n    Cause NVARCHAR(255),\n    Claim_Status NVARCHAR(100),\n    Fraud_Score FLOAT\n)\nWITH (DISTRIBUTION = HASH(Claim_ID), HEAP);\n\nCREATE TABLE insurance_xyz_dw_mart.Dim_External_Factors (\n    External_Data_ID UNIQUEIDENTIFIER NOT NULL,\n    Economic_Index FLOAT,\n    Weather_Conditions NVARCHAR(MAX)\n)\nWITH (DISTRIBUTION = HASH(External_Data_ID), HEAP);\n\n-- Hub Tables\nCREATE TABLE dbo.Hub_Clients (\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Client_Name NVARCHAR(255),\n    Address NVARCHAR(255),\n    Phone NVARCHAR(50),\n    Birth_Date DATE,\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Client_ID), HEAP);\n\nCREATE TABLE dbo.Hub_Policies (\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Policy_Type NVARCHAR(100),\n    Start_Date DATE,\n    End_Date DATE,\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Policy_ID), HEAP);\n\nCREATE TABLE dbo.Hub_Claims (\n    Claim_ID UNIQUEIDENTIFIER NOT NULL,\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Claim_Date DATE,\n    Cause NVARCHAR(255),\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Claim_ID), HEAP);\n\nCREATE TABLE dbo.Hub_External_Data (\n    External_Data_ID UNIQUEIDENTIFIER NOT NULL,\n    Data_Type NVARCHAR(100),\n    Data_Source NVARCHAR(255),\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(External_Data_ID), HEAP);\n\n-- Link Tables\nCREATE TABLE dbo.Link_Client_Policy (\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Client_ID), HEAP);\n\nCREATE TABLE dbo.Link_Policy_Claim (\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Claim_ID UNIQUEIDENTIFIER NOT NULL,\n    Created_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Policy_ID), HEAP);\n\n-- Satellite Tables\nCREATE TABLE dbo.Sat_Clients (\n    Client_ID UNIQUEIDENTIFIER NOT NULL,\n    Risk_Score FLOAT,\n    Income_Level NVARCHAR(100),\n    Last_Updated_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Client_ID), HEAP);\n\nCREATE TABLE dbo.Sat_Policies (\n    Policy_ID UNIQUEIDENTIFIER NOT NULL,\n    Premium_Amount DECIMAL(18,2),\n    Coverage_Details NVARCHAR(MAX),\n    Last_Updated_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Policy_ID), HEAP);\n\nCREATE TABLE dbo.Sat_Claims (\n    Claim_ID UNIQUEIDENTIFIER NOT NULL,\n    Claim_Amount DECIMAL(18,2),\n    Claim_Status NVARCHAR(100),\n    Last_Updated_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(Claim_ID), HEAP);\n\nCREATE TABLE dbo.Sat_External_Data (\n    External_Data_ID UNIQUEIDENTIFIER NOT NULL,\n    Economic_Index FLOAT,\n    Weather_Conditions NVARCHAR(MAX),\n    Last_Updated_At DATETIME NOT NULL\n)\nWITH (DISTRIBUTION = HASH(External_Data_ID), HEAP);\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "insuranse_xyz_DW",
				"poolName": "insuranse_xyz_DW"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}