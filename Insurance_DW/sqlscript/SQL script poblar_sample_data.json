{
	"name": "SQL script poblar_sample_data",
	"properties": {
		"content": {
			"query": "INSERT INTO dbo.Hub_Clients (Client_ID, Client_Name, Address, Phone, Birth_Date, Created_At)\nSELECT NEWID(), 'John Doe', '123 Main St', '555-1234', '1985-06-15', GETDATE()\nUNION ALL\nSELECT NEWID(), 'Jane Smith', '456 Oak Ave', '555-5678', '1990-09-21', GETDATE()\nUNION ALL\nSELECT NEWID(), 'Robert Brown', '789 Pine Rd', '555-8765', '1978-03-11', GETDATE();\n\nINSERT INTO dbo.Hub_Policies (Policy_ID, Client_ID, Policy_Type, Start_Date, End_Date, Created_At)\nSELECT NEWID(), (SELECT TOP 1 Client_ID FROM dbo.Hub_Clients ORDER BY NEWID()), 'Auto', '2024-01-01', '2025-01-01', GETDATE()\nUNION ALL\nSELECT NEWID(), (SELECT TOP 1 Client_ID FROM dbo.Hub_Clients ORDER BY NEWID()), 'Home', '2024-02-01', '2025-02-01', GETDATE()\nUNION ALL\nSELECT NEWID(), (SELECT TOP 1 Client_ID FROM dbo.Hub_Clients ORDER BY NEWID()), 'Life', '2023-05-01', '2043-05-01', GETDATE();\n\nINSERT INTO dbo.Hub_Claims (Claim_ID, Policy_ID, Claim_Date, Cause, Created_At)\nSELECT NEWID(), (SELECT TOP 1 Policy_ID FROM dbo.Hub_Policies ORDER BY NEWID()), '2024-01-15', 'Car accident', GETDATE()\nUNION ALL\nSELECT NEWID(), (SELECT TOP 1 Policy_ID FROM dbo.Hub_Policies ORDER BY NEWID()), '2024-02-10', 'House fire', GETDATE()\nUNION ALL\nSELECT NEWID(), (SELECT TOP 1 Policy_ID FROM dbo.Hub_Policies ORDER BY NEWID()), '2024-03-05', 'Medical emergency', GETDATE();\n\nINSERT INTO dbo.Hub_External_Data (External_Data_ID, Data_Type, Data_Source, Created_At)\nSELECT NEWID(), 'Economic', 'National Bureau of Statistics', GETDATE()\nUNION ALL\nSELECT NEWID(), 'Weather', 'Weather Channel', GETDATE()\nUNION ALL\nSELECT NEWID(), 'Demographics', 'Census Bureau', GETDATE();\n\nINSERT INTO dbo.Link_Client_Policy (Client_ID, Policy_ID, Created_At)\nSELECT c.Client_ID, p.Policy_ID, GETDATE()\nFROM dbo.Hub_Clients c\nJOIN dbo.Hub_Policies p ON NEWID() IS NOT NULL;\n\nINSERT INTO dbo.Link_Policy_Claim (Policy_ID, Claim_ID, Created_At)\nSELECT p.Policy_ID, c.Claim_ID, GETDATE()\nFROM dbo.Hub_Policies p\nJOIN dbo.Hub_Claims c ON NEWID() IS NOT NULL;\n\nINSERT INTO dbo.Sat_Clients (Client_ID, Risk_Score, Income_Level, Last_Updated_At)\nSELECT Client_ID, RAND() * 100, 'High', GETDATE() FROM dbo.Hub_Clients;\n\nINSERT INTO dbo.Sat_Policies (Policy_ID, Premium_Amount, Coverage_Details, Last_Updated_At)\nSELECT Policy_ID, 500 + (RAND() * 1000), 'Full coverage', GETDATE() FROM dbo.Hub_Policies;\n\nINSERT INTO dbo.Sat_Claims (Claim_ID, Claim_Amount, Claim_Status, Last_Updated_At)\nSELECT Claim_ID, 1000 + (RAND() * 5000), 'Pending', GETDATE() FROM dbo.Hub_Claims;\n\nINSERT INTO dbo.Sat_External_Data (External_Data_ID, Economic_Index, Weather_Conditions, Last_Updated_At)\nSELECT External_Data_ID, RAND() * 10, 'Sunny', GETDATE() FROM dbo.Hub_External_Data;\n\nINSERT INTO insurance_xyz_dw_mart.Fact_Claims (Claim_ID, Policy_ID, Client_ID, Claim_Date, Claim_Amount, Claim_Status, Fraud_Score, Risk_Score)\nSELECT c.Claim_ID, p.Policy_ID, cl.Client_ID, c.Claim_Date, 1000 + (RAND() * 5000), 'Approved', RAND() * 10, RAND() * 100\nFROM dbo.Hub_Claims c\nJOIN dbo.Hub_Policies p ON c.Policy_ID = p.Policy_ID\nJOIN dbo.Hub_Clients cl ON p.Client_ID = cl.Client_ID;\n\nINSERT INTO insurance_xyz_dw_mart.Fact_Policies (Policy_ID, Client_ID, Premium_Amount, Start_Date, End_Date, Policy_Type)\nSELECT Policy_ID, Client_ID, 500 + (RAND() * 1000), Start_Date, End_Date, Policy_Type\nFROM dbo.Hub_Policies;\n\nINSERT INTO insurance_xyz_dw_mart.Fact_Customer_Risk (Client_ID, Risk_Score, Number_of_Claims, Premium_Amount, Economic_Index, Weather_Conditions)\nSELECT c.Client_ID, RAND() * 100, FLOOR(RAND() * 5), 500 + (RAND() * 1000), RAND() * 10, 'Cloudy'\nFROM dbo.Hub_Clients c;\n\nINSERT INTO insurance_xyz_dw_mart.Dim_Clients (Client_ID, Client_Name, Address, Phone, Birth_Date, Risk_Category)\nSELECT Client_ID, Client_Name, Address, Phone, Birth_Date, 'Medium'\nFROM dbo.Hub_Clients;\n\nINSERT INTO insurance_xyz_dw_mart.Dim_Policies (Policy_ID, Policy_Type, Premium_Amount, Coverage_Details)\nSELECT Policy_ID, Policy_Type, 500 + (RAND() * 1000), 'Basic coverage'\nFROM dbo.Hub_Policies;\n\nINSERT INTO insurance_xyz_dw_mart.Dim_Claims (Claim_ID, Claim_Date, Claim_Amount, Cause, Claim_Status, Fraud_Score)\nSELECT Claim_ID, Claim_Date, 1000 + (RAND() * 5000), Cause, 'Processed', RAND() * 10\nFROM dbo.Hub_Claims;\n\nINSERT INTO insurance_xyz_dw_mart.Dim_External_Factors (External_Data_ID, Economic_Index, Weather_Conditions)\nSELECT External_Data_ID, RAND() * 10, 'Rainy'\nFROM dbo.Hub_External_Data;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "insuranse_xyz_DW",
				"poolName": "insuranse_xyz_DW"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}